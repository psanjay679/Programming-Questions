class Solution:

    def bin_search(self, ar, ci):

        low = 0
        high = len(ar) - 1
        ans = -1

        while low <= high:
            mid = (low + high) // 2
            if ar[mid] < ci:
                ans = mid
                low = mid + 1
            else:
                high = mid - 1

        return ans

    def solve(self, A, B, C):

        a_ar = list()
        b_ar = list()

        if A == 1:
            a_ar = [1]
        else:
            k = 1
            while k < (1 << 32):
                a_ar.append(k)
                k = k * A

        if B == 1:
            b_ar = [1]
        else:
            k = 1
            while k < (1 << 32):
                b_ar.append(k)
                k = k * B
        ar = set()

        for ael in a_ar:
            for bel in b_ar:
                ar.add(ael + bel)

        ar = list(ar)
        ar.sort()
        ret_val = list()

        for ci in C:
            ret_val.append(self.bin_search(ar, ci) + 1)

        return ret_val

def find_custom_val():
    val = 17742

    a = 1
    b = 1
    cnt = 0
    s = set()
    while a < val:
        while b < val:
           if a + b < val:
               cnt += 1
               s.add(a + b)
           else:
               break

           b = b * 4
        b = 1
        a = a * 3

    print (len(s))
    print (cnt)

# find_custom_val()

if __name__ == '__main__':

    A = 3
    B = 4
    C = [ 17742, 4324, 20504, 30549, 4054, 14340, 31345, 24257, 15455, 5342, 27784, 23488, 23069, 9794, 17373, 8070, 13502, 21042, 29623, 20176, 12314, 5908, 4401, 11727, 12827, 15409, 21422, 17659, 1190, 30568, 16919, 13518, 5203, 7541, 16940, 20022, 387, 20818, 19514, 30115, 15591, 2284, 3205, 28000, 1355, 29322, 20052, 10968, 1084, 5518, 2475, 7488, 4208, 21438, 17380, 1895, 27772, 21448, 28309, 2944, 5900, 29170, 27943, 8961, 21159, 12269, 8036, 23754, 5825, 13487, 29194, 29233, 29799, 6268, 19948, 239, 26309, 30337, 14069, 2098, 20796, 5841, 4048, 13440, 11461, 26332, 9089, 24352, 24710, 15395, 12526, 21372, 19085, 9105, 19635, 2960, 7346, 28847, 26689, 16007, 1833, 3684, 17049, 23843, 13498, 24336, 17930, 6043, 29696, 8190, 26520, 12863, 30049, 4333, 6294, 8255, 21760, 27491, 3459, 29700, 20677, 12163, 15565, 16216, 23035, 19068, 10388, 11147, 22781, 10834, 9077, 29774, 26416, 4571, 12263, 2023, 6982, 28775, 19420, 8519, 29633, 6399, 18323, 24482, 4255, 14586, 13895, 18234, 7011, 14586, 24798, 19593, 27760, 4098, 23995 ]


    s = Solution()
    print(s.solve(A, B, C))